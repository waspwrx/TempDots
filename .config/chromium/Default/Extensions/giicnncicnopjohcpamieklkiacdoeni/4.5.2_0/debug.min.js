$(document).ready(function(){var info={};var isOnline=window.navigator.onLine;if(isOnline){$("#general-connectivity-value").text("Online");$("#general-connectivity-status").addClass("text-success").text("OK")}else{$("#general-connectivity-value").text("Offline");$("#general-connectivity-status").addClass("text-success").text("ERROR (check Internet connection)")}info.online=isOnline;console.log("online: "+isOnline);if(window.navigator.userAgent.match(/Firefox/)){$("#general-browser-name-value").text("Firefox");$("#general-browser-name-status").addClass("text-danger").text("ERROR (browser not yet supported)")}else if(window.navigator.userAgent.match(/OPR/)){$("#general-browser-name-value").text("Opera");$("#general-browser-name-status").addClass("text-danger").text("ERROR (browser not yet supported)")}else if(window.navigator.userAgent.match(/Vivaldi/)){$("#general-browser-name-value").text("Vivaldi");$("#general-browser-name-status").addClass("text-danger").text("ERROR (browser not yet supported)")}else if(window.navigator.userAgent.match(/Edge/)){$("#general-browser-name-value").text("Edge");$("#general-browser-name-status").addClass("text-danger").text("ERROR (browser not yet supported)")}else if(window.navigator.userAgent.match(/Chrome/)){$("#general-browser-name-value").text("Chrome or Chromium");$("#general-browser-name-status").addClass("text-success").text("OK")}else{$("#general-browser-name-value").text("Unknown");$("#general-browser-name-status").addClass("text-danger").text("ERROR (unknown browser)")}info.ua=window.navigator.userAgent;console.log("user agent: "+window.navigator.userAgent);var version=window.navigator.userAgent.match(/Chrome\/(.+?)\./);if(version!=null&&Array.isArray(version)&&version.length>0){version=+version[1];$("#general-browser-version-value").text(version);if(version<MIN_VERSION){$("#general-browser-version-status").addClass("text-danger").text("ERROR (please update your browser)")}else{$("#general-browser-version-status").addClass("text-success").text("OK")}}else{$("#general-browser-version-value").text("Unknown");$("#general-browser-version-status").addClass("text-danger").text("ERROR (unable to detect browser version)")}$.ajax({url:"https://desktopnotifications.hci.simtech.uni-stuttgart.de/ping.txt",cache:false,complete:function(jqXHR,textStatus){if(textStatus=="success"||textStatus=="notmodified"){$("#general-server-value").text("success");$("#general-server-status").addClass("text-success").text("OK")}else{$("#general-server-value").text(textStatus);$("#general-server-status").addClass("text-danger").text("ERROR (firewall? server unavailable?)")}info.ping=textStatus},dataType:"text"});if(chrome.identity){chrome.identity.getAuthToken({interactive:false},function(token){if(token){$("#general-identity-value").text("Yes");$("#general-identity-status").addClass("text-success").text("OK");console.log("identity token: "+token.substr(0,25));info.token=token}else{$("#general-identity-value").text("No");$("#general-identity-status").addClass("text-danger").text("ERROR (not signed in)");$("#card-devices").hide();info.token=null}})}else{$("#general-identity-value").text("Unavailable");$("#general-identity-status").addClass("text-danger").text("ERROR (unsupported browser)");$("#card-devices").hide();info.token=false}getInstanceID(function(iid){if(iid==null||iid=="notimplementedyet"){$("#general-instance-id-value").text("Unavailable");$("#general-instance-id-status").addClass("text-danger").text("ERROR (unsupported browser)");info.iid=null}else{$("#general-instance-id-value").text("Yes");$("#general-instance-id-status").addClass("text-success").text("OK");info.iid=iid;console.log("iid: "+iid)}});if(chrome.gcm){$("#general-gcm-availability-value").text("Yes");$("#general-gcm-availability-status").addClass("text-success").text("OK");info.gcm=true}else{$("#general-gcm-availability-value").text("No");$("#general-gcm-availability-status").addClass("text-danger").text("ERROR (unsupported browser)");$("#card-gcm").hide();info.gcm=false}var testCount=0;$("#test").on("click",function(){testCount++;var options={type:"basic",iconUrl:"images/appicons/org.hcilab.projects.notification.test.webp",title:"Desktop Notifications",message:"Test #"+testCount,priority:0};chrome.notifications.create("_test"+testCount,options,function(){})})});